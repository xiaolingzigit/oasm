<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hd.jy.oasm.dao.DafxpgbgMapper" >
  <resultMap id="BaseResultMap" type="com.hd.jy.oasm.domain.Dafxpgbg" >
    <id column="qh" property="qh" jdbcType="NUMERIC" />
    <result column="zsxm" property="zsxm" jdbcType="VARCHAR" />
    <result column="bgscsj" property="bgscsj" jdbcType="DATE" />
    <result column="dafxfz" property="dafxfz" jdbcType="INTEGER" />
    <result column="status" property="status" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Base_Column_List" >
    qh, zsxm, bgscsj, dafxfz, status
  </sql>
  
  <!-- 入监档案分析 -->
  <select id="selectDafxbgKey" resultMap="BaseResultMap" parameterType="java.lang.String">
     select qh,zsxm,bgscsj,dafxfz from TB_dafxpgbg 
     <if test="_parameter!=null and _parameter!=''">
        where (zsxm like concat(concat('%',#{name}),'%'))
        </if>
     order by dafxfz desc 
  </select>
  
  
  <select id="selectDafxbg" resultMap="BaseResultMap">
     select qh,zsxm,bgscsj,dafxfz from TB_dafxpgbg order by dafxfz desc
  </select>
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    select 
    <include refid="Base_Column_List" />
    from TB_dafxpgbg
    where qh = #{qh,jdbcType=NUMERIC}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    delete from TB_dafxpgbg
    where qh = #{qh,jdbcType=NUMERIC}
  </delete>
  <insert id="insert" parameterType="com.hd.jy.oasm.domain.Dafxpgbg" >
    insert into TB_dafxpgbg (qh, zsxm, bgscsj, 
      dafxfz, status)
    values (#{qh,jdbcType=NUMERIC}, #{zsxm,jdbcType=VARCHAR}, #{bgscsj,jdbcType=DATE}, 
      #{dafxfz,jdbcType=INTEGER}, #{status,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.hd.jy.oasm.domain.Dafxpgbg" >
    insert into TB_dafxpgbg
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="qh != null" >
        qh,
      </if>
      <if test="zsxm != null" >
        zsxm,
      </if>
      <if test="bgscsj != null" >
        bgscsj,
      </if>
      <if test="dafxfz != null" >
        dafxfz,
      </if>
      <if test="status != null" >
        status,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="qh != null" >
        #{qh,jdbcType=NUMERIC},
      </if>
      <if test="zsxm != null" >
        #{zsxm,jdbcType=VARCHAR},
      </if>
      <if test="bgscsj != null" >
        #{bgscsj,jdbcType=DATE},
      </if>
      <if test="dafxfz != null" >
        #{dafxfz,jdbcType=INTEGER},
      </if>
      <if test="status != null" >
        #{status,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.hd.jy.oasm.domain.Dafxpgbg" >
    update TB_dafxpgbg
    <set >
      <if test="zsxm != null" >
        zsxm = #{zsxm,jdbcType=VARCHAR},
      </if>
      <if test="bgscsj != null" >
        bgscsj = #{bgscsj,jdbcType=DATE},
      </if>
      <if test="dafxfz != null" >
        dafxfz = #{dafxfz,jdbcType=INTEGER},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=INTEGER},
      </if>
    </set>
    where qh = #{qh,jdbcType=NUMERIC}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.hd.jy.oasm.domain.Dafxpgbg" >
    update TB_dafxpgbg
    set zsxm = #{zsxm,jdbcType=VARCHAR},
      bgscsj = #{bgscsj,jdbcType=DATE},
      dafxfz = #{dafxfz,jdbcType=INTEGER},
      status = #{status,jdbcType=INTEGER}
    where qh = #{qh,jdbcType=NUMERIC}
  </update>
  
  <insert id="saveOrUpdate" >
	  <selectKey keyProperty="status" resultType="com.hd.jy.oasm.domain.Dafxpgbg" order="BEFORE">
	    select count(*) as status from TB_dafxpgbg where qh = #{qh}
	  </selectKey>
	  <if test="status == 1">
	    update TB_dafxpgbg
   		set zsxm = #{zsxm},
     		bgscsj = #{bgscsj},
      		dafxfz = #{dafxfz},
      		status = 1
   		where qh = #{qh}
	  </if>
	  <if test="status == 0">
	    insert into TB_dafxpgbg (qh, zsxm, bgscsj,dafxfz,status)
    	values (#{qh}, #{zsxm}, #{bgscsj}, #{dafxfz},#{status})
	  </if>
  </insert>
</mapper>